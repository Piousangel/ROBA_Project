<html>
    <head>
        <title>제목</title>
        <meta charset="utf-8"/>
        <link
            rel="stylesheet"
            href="{{ url_for('static', filename='css/layout.css') }}">
        <link
            rel="stylesheet"
            href="{{ url_for('static', filename='css/Menu_Select_Blending.css') }}">
    </head>
    <body
        onload="init();"
        oncontextmenu='return false'
        onselectstart='return false'
        ondragstart='return false'>
        <div id="wrap">
            <div class="menu_select">
                <p id="choice_bean" class="font_50">원두 종류 선택</p>
                <p id="sort_text" class="font_40_red">정렬</p>
                <div class="radio">
                    <div id="sort_0" class="z-top">
                        <img
                            hidden="hidden"
                            src="/static/imgs/ROBA_2-1_sweet_selected.png"
                            class="img_relative"
                            name="sort_0_selected">
                        <img
                            hidden="hidden"
                            src="/static/imgs/ROBA_2-1_sweet_unselected.png"
                            class="img_relative"
                            name="sort_0_unselected">
                    </div>
                    <div id="sort_1" class="z-top">
                        <img
                            hidden="hidden"
                            src="/static/imgs/ROBA_2-1_body_selected.png"
                            class="img_relative"
                            name="sort_1_selected">
                        <img
                            hidden="hidden"
                            src="/static/imgs/ROBA_2-1_body_unselected.png"
                            class="img_relative"
                            name="sort_1_unselected">
                    </div>
                    <div id="sort_2" class="z-top">
                        <img
                            hidden="hidden"
                            src="/static/imgs/ROBA_2-1_sour_selected.png"
                            class="img_relative"
                            name="sort_2_selected">
                        <img
                            hidden="hidden"
                            src="/static/imgs/ROBA_2-1_sour_unselected.png"
                            class="img_relative"
                            name="sort_2_unselected">
                    </div>
                </div>
                
            </div>
            <div class="lostaric_1">
                <img src="/static/imgs/lostaric_img.png" alt="logo" class="coffee lostaric"/>
            </div>
            <div>
                <img src="/static/imgs/terasosa_img.png" alt="logo" class="coffee terarosa"/>
            </div>
            <div>
                <img src="/static/imgs/indonisia_img.png" alt="logo" class="coffee indonasia"/>
            </div>
            <img
                src="/static/imgs/ROBA_23_backArrow.png"
                alt="logo"
                id="arrow"
                onclick="goBack()"/>
            <img src="/static/imgs/ROBA_2-1_bgLine.png" alt="logo" id="line"/>
            <p id="amekor" class="font_60">아메리카노</p>
            <p id="americano" class="font_40">Americano</p>

            <div id="remain_div">
                <img src="/static/imgs/ROBA_2-1_ratioBG.png" id="_ratio" alt="alt">
                <p id="remain_font" class="font_30_red" name="remain_font">남은 비율:</p>
                <p id="remain_ratio" class="font_30_red" name="remain_ratio">100%</p>
                <!--임의로 넣었습니다.-->
            </div>

            <p id="lostaric_2" class="font_40">로스터릭 코스타리카 허니</p>
            <p id="terarosa_2" class="font_40">테라로사 에티오피아</p>
            <p id="indonasia_2" class="font_40">인도네시아 만델링</p>
            <img
                src="/static/imgs/ROBA_2-1_beaker_filled_lightBrown.png"
                alt="logo2"
                id="losta_cup"/>
            <img
                src="/static/imgs/ROBA_2-1_beaker_filled_brown.png"
                alt="logo3"
                id="tera_cup"/>
            <img src="/static/imgs/ROBA_2-1_beaker_3.png" alt="logo" id="indo_cup"/>

            <div class="los_background">
                <img src="/static/imgs/ROBA_2-1_ratioBtn.png" alt="logo" class="los_arrow"/>
                <p class="percent los_percent font_60" id="los_per">{{blender_1}}%</p>
                <p id="blender_0_down" name="lostaric_percentdown"></p>
                <p id="blender_0_up" name="lostaric_percentup"></p>
            </div>
            <div class="tera_background">
                <img src="/static/imgs/ROBA_2-1_ratioBtn.png" alt="logo" class="tera_arrow"/>
                <p class="percent tera_percent  font_60" id="tera_per">{{blender_2}}%</p>
                <p id="blender_1_down" name="tera_percentdown"></p>
                <p id="blender_1_up" name="tera_percentup"></p>
            </div>
            <div class="indo_background">
                <img src="/static/imgs/ROBA_2-1_ratioBtn.png" alt="logo" class="indo_arrow"/>
                <p class="percent indo_percent  font_60" id="indo_per">{{blender_3}}%</p>
                <p id="blender_2_down" name="indo_percentdown"></p>
                <p id="blender_2_up" name="indo_percentup"></p>
            </div>
        </div>

        <img
            hidden="hidden"
            class="order"
            name="img_not_yet"
            src="/static/imgs/ROBA_2-2_선택완료_notyet.png">
        <img
            hidden="hidden"
            class="order z-top"
            name="img_yet"
            src="/static/imgs/ROBA_2_button.png"
            onclick="orderform()">

    </div>
    <script src="//code.jquery.com/jquery-3.2.1.min.js"></script>
    <script type="text/javascript">
        var sort_0 = [window.document.sort_0_unselected, window.document.sort_0_selected];
        var sort_1 = [window.document.sort_1_unselected, window.document.sort_1_selected];
        var sort_2 = [window.document.sort_2_unselected, window.document.sort_2_selected];

        var losvalue = parseInt(document.getElementById("los_per").innerText);
        var teravalue = parseInt(document.getElementById("tera_per").innerText);
        var indovalue = parseInt(document.getElementById("indo_per").innerText);
        var remain_ratio = 100 - losvalue - teravalue - indovalue;

        var btn = [window.document.img_not_yet, window.document.img_yet]

        var val = 10;
        function init() {
            img_hide(sort_0);
            img_hide(sort_1);
            img_hide(sort_2);
            img_hide(btn);

            sort_0[0].hidden = false;
            sort_1[1].hidden = false;
            sort_2[0].hidden = false;

            btn[0].hidden = false;

            var radio = [document.getElementById("sort_0"), document.getElementById("sort_1"), document.getElementById("sort_2")];
            for (var i = 0; i < radio.length; i++) {
                radio[i].addEventListener("mouseup", function () {
                    sort_change(i)
                })

            }


            var ratio = [
                [document.getElementById("blender_0_up"), document.getElementById("blender_0_down")],
                [document.getElementById("blender_1_up"), document.getElementById("blender_1_down")],
                [document.getElementById("blender_2_up"), document.getElementById("blender_2_down")]
            ]
            for (var blender = 0; blender < ratio.length; blender++) {
                for (var btn_ud = 0; btn_ud < ratio[0].length; btn_ud++) {
                    ratio[blender][btn_ud].addEventListener("mouseup", function () {
                        ratio_change(blender, btn_ud)
                    })
                }
            }

            document
                .getElementById("remain_ratio")
                .innerText = remain_ratio.toString() + "%";

            if (remain_ratio == 0) {
                img_hide(btn);
                btn[1].hidden = false;
            }
        }

        function ratio_change(blender, btn_ud){
            if(btn_ud == 0){
                ratio_up(blender);
            }
            else{
                ratio_down(blender);
            }
        }

        function ratio_down(value) {
            if (value == 0) {
                if (losvalue != 0) {
                    losvalue -= 10;
                    remain_ratio += 10;
                }
            } else if (value == 1) {
                if (teravalue != 0) {
                    teravalue -= 10;
                    remain_ratio += 10;
                }
            } else if (value == 2) {
                if (indovalue != 0) {
                    indovalue -= 10;
                    remain_ratio += 10;
                }
            }

            if (remain_ratio != 0) {
                img_hide(btn);
                btn[0].hidden = false;
            }
            document
                .getElementById("los_per")
                .innerText = losvalue.toString() + "%";
            document
                .getElementById("tera_per")
                .innerText = teravalue.toString() + "%";
            document
                .getElementById("indo_per")
                .innerText = indovalue.toString() + "%";
            document
                .getElementById("remain_ratio")
                .innerText = remain_ratio.toString() + "%";
        }

        function ratio_up(value) {
            if (remain_ratio != 0) {
                if (value == 0) {
                    if (losvalue != 100) {
                        losvalue += 10;
                        remain_ratio -= 10;
                    }
                } else if (value == 1) {
                    if (teravalue != 100) {
                        teravalue += 10;
                        remain_ratio -= 10;
                    }
                } else if (value == 2) {
                    if (indovalue != 100) {
                        indovalue += 10;
                        remain_ratio -= 10;
                    }
                }
            }

            if (remain_ratio == 0) {
                img_hide(btn);
                btn[1].hidden = false;
            }
            document
                .getElementById("los_per")
                .innerText = losvalue.toString() + "%";
            document
                .getElementById("tera_per")
                .innerText = teravalue.toString() + "%";
            document
                .getElementById("indo_per")
                .innerText = indovalue.toString() + "%";

            document
                .getElementById("remain_ratio")
                .innerText = remain_ratio.toString() + "%";
        }

        function img_hide(array) {
            for (var i = 0; i < array.length; i++) {
                array[i].hidden = true;
            }
        }

        function sort_change(value) {
            img_hide(sort_0);
            img_hide(sort_1);
            img_hide(sort_2);
            if (value == 0) {
                sort_0[1].hidden = false;
                sort_1[0].hidden = false;
                sort_2[0].hidden = false;
            } else if (value == 1) {
                sort_0[0].hidden = false;
                sort_1[1].hidden = false;
                sort_2[0].hidden = false;
            } else {
                sort_0[0].hidden = false;
                sort_1[0].hidden = false;
                sort_2[1].hidden = false;
            }
        }
        function goBack() {
            sendGet("/Main");
        }
        function sendGet(action) {
            var form = document.createElement('form');
            form.setAttribute('method', 'get');
            form.setAttribute('action', action);
            document.charset = "utf-8";
            var hiddenField = document.createElement('input');
            hiddenField.setAttribute('type', 'hidden');
            form.appendChild(hiddenField);
            document
                .body
                .appendChild(form);
            form.submit();
        }
        $(".sweet").on('click', function () {
            $(".lostaric").animate({
                top: 660
            }, 1000);
            $(".terarosa").animate({
                top: 850
            }, 1000);
            $(".indonasia").animate({
                top: 480
            }, 1000);
        })
        $(".bodygam").on('click', function () {
            $(".lostaric").animate({
                top: 480
            }, 1000);
            $(".terarosa").animate({
                top: 660
            }, 1000);
            $(".indonasia").animate({
                top: 850
            }, 1000);
        })
        $(".sanme").on('click', function () {
            $(".lostaric").animate({
                top: 840
            }, 1000);
            $(".terarosa").animate({
                top: 480
            }, 1000);
            $(".indonasia").animate({
                top: 660
            }, 1000);
        })
        var timeT = document.getElementById("runningtime");/*window.onload = function()
{
cnt = 10;
//countdown();
}    function countdown()
{
if(cnt == 0)
{
    sendPost('/Order_Timeout');
}
else{
timeT.innerText = cnt;
setTimeout("countdown()", 1000);
cnt--;
}
}*/
        function orderform() {
            var json = {
                "Blender_1": losvalue.toString(),
                "Blender_2": teravalue.toString(),
                "Blender_3": indovalue.toString()
            };
            sendPost("/Menu_Select_Blending", json);
        }
        function sendPost(action, params) {
            var form = document.createElement('form');
            form.setAttribute('method', 'post');
            form.setAttribute('action', action);
            document.charset = "utf-8";
            for (var key in params) {
                var hiddenField = document.createElement('input');
                hiddenField.setAttribute('type', 'hidden');
                hiddenField.setAttribute('name', key);
                hiddenField.setAttribute('value', params[key]);
                form.appendChild(hiddenField);
            }
            document
                .body
                .appendChild(form);
            form.submit();
        }
    </script>
</body>
</html>